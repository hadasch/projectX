{
    "collab_server" : "",
    "contents" : "require(asreml)\n\nGxEmeans <- read.delim(\"GxE_means.txt\")\n\n########################################\n### Eberhart-Russell factor analytic ### \n########################################\n\nER_fa_mod <- asreml(fixed   = GxE_mean ~ G,\n                    random  = ~ fa(G,k=1):E,\n                    family  = asreml.gaussian(dispersion=10e-5),\n                    control = asreml.control(pworkspace=8e8,\n                                             workspace=8e8, \n                                             maxiter=100),\n                    data    = GxEmeans)\n\n# format variance component output\nVC  <- summary(ER_fa_mod)$varcomp[2:3]\nVC$name <- gsub(\"E!G.\",\"\",substr(rownames(VC),regexpr(\"!\",rownames(VC))-1,nchar(rownames(VC))))\nrow.names(VC) <- NULL\n\nVC_t <- data.frame(G     = unique(substr(VC$name,1,nchar(VC$name)-4)[1:(dim(VC)[1]-1)/2]),\n                   Var   = VC[which(substr(VC$name,nchar(VC$name)-2,nchar(VC$name))==\"var\"),\"component\"],\n                   Lamda = VC[which(substr(VC$name,nchar(VC$name)-2,nchar(VC$name))==\"fa1\"),\"component\"])\n\n# BLUEs\nBLUEs <- predict(ER_fa_mod, classify=\"G\")$pred$pvals[,c('G','predicted.value')]\ncolnames(BLUEs) <- c(\"G\",\"BLUE\")\n\n# BLUPs\nBLUPs <- data.frame(name = names(ER_fa_mod$coefficients$random),\n                    BLUP = ER_fa_mod$coefficients$random)\nrow.names(BLUPs) <- NULL\n\n# Predictions\nPreds <- predict(ER_fa_mod, classify=\"fa(G, k = 1):E\")$pred$pvals[,c('G','E','predicted.value')]\ncolnames(BLUEs) <- c(\"G\",\"BLUE\")\n",
    "created" : 1512669656750.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "513575355",
    "id" : "35CD9F06",
    "lastKnownWriteTime" : 1512744201,
    "last_content_update" : 1512744201289,
    "path" : "D:/User/pschmidt/Desktop/GitHub/projectX/examplecode/FA-Modell Eberhart-Russell.R",
    "project_path" : "FA-Modell Eberhart-Russell.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}